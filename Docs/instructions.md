# Manual Instructions for Log Reorganization

The recent log reorganization requires a few manual changes to your crontab configuration to ensure all processes continue to work correctly.

Please edit your crontab (`crontab -e`) and make the following modifications:

## 1. Update Path for `master_subscriber_log.csv`

The `master_subscriber_log.csv` file, generated by `generate_subscriber_log.py`, is now located in the `logs/roi/` subdirectory. You need to update the `aws s3 cp` commands that upload this file.

**Change this line:**
```cron
30 22 * * * /home/ec2-user/tipping-monster/.venv/bin/python /home/ec2-user/tipping-monster/roi/generate_subscriber_log.py --date $(date +\%F) && aws s3 cp /home/ec2-user/tipping-monster/logs/master_subscriber_log.csv s3://tipping-monster-data/master_subscriber_log.csv
```
**To this:**
```cron
30 22 * * * /home/ec2-user/tipping-monster/.venv/bin/python /home/ec2-user/tipping-monster/roi/generate_subscriber_log.py --date $(date +\%F) && aws s3 cp /home/ec2-user/tipping-monster/logs/roi/master_subscriber_log.csv s3://tipping-monster-data/master_subscriber_log.csv
```

**And change this line:**
```cron
59 23 * * * /usr/local/bin/aws s3 cp /home/ec2-user/tipping-monster/logs/master_subscriber_log.csv s3://tipping-monster-data/ --region eu-west-2 >> /home/ec2-user/tipping-monster/logs/s3_upload.log 2>&1
```
**To this:**
```cron
59 23 * * * /usr/local/bin/aws s3 cp /home/ec2-user/tipping-monster/logs/roi/master_subscriber_log.csv s3://tipping-monster-data/ --region eu-west-2 >> /home/ec2-user/tipping-monster/logs/s3_upload.log 2>&1
```

## 2. Update Log Cleaning Command

The command that cleans up old `.log` files needs to be updated to ensure it processes the new subdirectories within `logs/`.

**Change this line:**
```cron
0 3 * * * find /home/ec2-user/tipping-monster/logs/ -type f -name "*.log" -mtime +14 -delete
```
**To this (recommended):**
```cron
0 3 * * * find /home/ec2-user/tipping-monster/logs/ -type f -name "*.log" -mtime +14 -delete
```
**Reasoning:** The `find` command, when given a directory path, searches recursively by default. This change ensures that `.log` files older than 14 days in `logs/` and all its subdirectories (e.g., `logs/roi/`, `logs/dispatch/`) are deleted. The quotes around `*.log` have been simplified.

After making these changes, save your crontab.
